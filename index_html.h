String INDEX_HTML = R"=====(<!DOCTYPE html>
<html><head><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><title>{NAME}</title><link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css"><link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css"><script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script><script src="https://unpkg.com/jquery/dist/jquery.min.js"></script><script>const BLIND_COUNT=2,baseIpEnd=150,cversion="{VERSION}",wsUriTemplate="ws://192.168.1.150:81/",repo="motor-on-roller-blind-ws",blindHomeSectionTemplate=`<ons-card><ons-row><ons-col style="text-align:center"><h1>Blind {BLIND_NUMBER}</h1></ons-col><ons-col style="text-align:center;margin-top:25px">Connection:<ons-icon id="conn_status_icon_{BLIND_NUMBER}" icon="fa-circle" style="color:#ff0"></ons-col></ons-row></ons-card><ons-card><div class="title">Adjust position</div><div class="content"><p>Move the slider to the wanted position or use the arrows to open/close to the max positions</p></div><ons-row><ons-col width="40px" style="text-align:center;line-height:31px"></ons-col><ons-col><ons-progress-bar id="pbar_{BLIND_NUMBER}" value="75"></ons-progress-bar></ons-col><ons-col width="40px" style="text-align:center;line-height:31px"></ons-col></ons-row><ons-row><ons-col width="40px" style="text-align:center;line-height:31px"><ons-icon id="arrow-open_{BLIND_NUMBER}" class="arrow-open" blind-number="{BLIND_NUMBER}" icon="fa-arrow-up" size="2x"></ons-icon></ons-col><ons-col><ons-range id="setrange_{BLIND_NUMBER}" class="setrange" blind-number="{BLIND_NUMBER}" style="width:100%" value="25"></ons-range></ons-col><ons-col width="40px" style="text-align:center;line-height:31px"><ons-icon id="arrow-close_{BLIND_NUMBER}" class="arrow-close" blind-number="{BLIND_NUMBER}" icon="fa-arrow-down" size="2x"></ons-icon></ons-col></ons-row></ons-card>`,blindSettingSectionTemplate=`<ons-card><ons-row><ons-col style="text-align:center"><h1>Blind {BLIND_NUMBER}</h1></ons-col></ons-row></ons-card><ons-card><div class="title">Control</div><ons-row style="width:100%"><ons-col style="text-align:center"><ons-icon id="arrow-up-man_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="arrow-up-man" icon="fa-arrow-up" size="2x"></ons-icon></ons-col><ons-col style="text-align:center"><ons-icon id="arrow-stop-man_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="arrow-stop-man" icon="fa-stop" size="2x"></ons-icon></ons-col><ons-col style="text-align:center"><ons-icon id="arrow-down-man_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="arrow-down-man" icon="fa-arrow-down" size="2x"></ons-icon></ons-col></ons-row></ons-card><ons-card><div class="title">Store</div><ons-row style="width:100%"><ons-col style="text-align:center"><ons-button id="set-start_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="set-start">Set Start</ons-button></ons-col><ons-col style="text-align:center">&nbsp;</ons-col><ons-col style="text-align:center"><ons-button id="set-max_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="set-max">Set Max</ons-button></ons-col></ons-row></ons-card><ons-card><div class="title">Scheduler</div><ons-row style="width:100%"><ons-col style="text-align:center">Open at: <input id="timepicker_open_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" type="time" class="text-input timepicker_open" ng-model="inputTime"></ons-col><ons-col style="text-align:center">&nbsp;</ons-col><ons-col style="text-align:center">Close at: <input id="timepicker_close_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" type="time" class="text-input timepicker_close" ng-model="inputTime"></ons-col></ons-row><ons-row style="width:100%"><ons-col style="text-align:center"><ons-button id="set-schedule_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="set-schedule">Save Schedule</ons-button></ons-col><ons-col style="text-align:center">&nbsp;</ons-col><ons-col style="text-align:center"><ons-button id="clear-schedule_{BLIND_NUMBER}" blind-number="{BLIND_NUMBER}" class="button button--outline clear-schedule">Clear Schedule</ons-button></ons-col></ons-row></ons-card>`;window.fn={},window.fn.open=function(){document.getElementById("menu").open()},window.fn.load=function(n){var t=document.getElementById("content"),o=document.getElementById("menu");t.load(n).then(o.close.bind(o)).then(setActions())};const gotoPos=function(n,t){doSend(n,"percent",t)},setActions=function(){setTimeout(function(){doSend(void 0,"update",0)},500),$.get("https://api.github.com/repos/ahmetsari/motor-on-roller-blind-ws/releases",function(n){n.length>0&&n[0].tag_name!==cversion&&($("#cversion").text(cversion),$("#nversion").text(n[0].tag_name),$("#update-card").show())}),setTimeout(function(){renderPage(),setTimeout(function(){doSend(void 0,"update",0)},200),$(".arrow-close").on("click",function(){let n=$(this).attr("blind-number");$("#setrange_"+n).val(100),gotoPos(n-1,100)}),$(".arrow-open").on("click",function(){let n=$(this).attr("blind-number");$("#setrange_"+n).val(0),gotoPos(n-1,0)}),$(".setrange").on("change",function(){let n=$(this).attr("blind-number");gotoPos(n-1,$("#setrange_"+n).val())}),$(".arrow-up-man").on("click",function(){let n=$(this).attr("blind-number");doSend(n-1,"manual",-1)}),$(".arrow-down-man").on("click",function(){let n=$(this).attr("blind-number");doSend(n-1,"manual",1)}),$(".arrow-stop-man").on("click",function(){let n=$(this).attr("blind-number");doSend(n-1,"manual",0)}),$(".set-start").on("click",function(){let n=$(this).attr("blind-number");doSend(n-1,"start",0)}),$(".set-max").on("click",function(){let n=$(this).attr("blind-number");doSend(n-1,"max",0)}),$(".clear-schedule").on("click",function(){let n=$(this).attr("blind-number");$("#timepicker_open_"+n.toString()).val(""),$("#timepicker_close_"+n.toString()).val("")}),$(".set-schedule").on("click",function(){let n=$(this).attr("blind-number"),t=$("#timepicker_open_"+n.toString()).val(),o=$("#timepicker_close_"+n.toString()).val();doSend(n-1,"schedule",t+";"+o)})},200)};$(document).ready(function(){setActions()});var websocketArr=[],timeOutArr=[];function retry(n){clearTimeout(timeOutArr[n]),timeOutArr[n]=setTimeout(function(){websocket=null,initWs(n)},5e3)}function renderPage(){let n=document.getElementById("pageContent"),t=document.getElementById("settingsContent");for(let o=1;o<=2;o++)n&&(n.innerHTML+=blindHomeSectionTemplate.replaceAll("{BLIND_NUMBER}",o.toString())),t&&(t.innerHTML+=blindSettingSectionTemplate.replaceAll("{BLIND_NUMBER}",o.toString()))}function onload(){initAllWebsockets()}function initAllWebsockets(){for(let n=0;n<2;n+=2)initWs(n)}function getWsUri(n){return"ws://192.168.1.150:81/".replace("{IP_END}",150+n)}async function initWs(n){let t=n+1;setTimeout(function(){$("#conn_status_icon_"+t).css("color","yellow")},1),setTimeout(function(){$("#conn_status_icon_"+(t+1)).css("color","yellow")},1),ons.notification.toast({message:"Connecting to device "+t.toString()+"...",timeout:1e3});try{let o=new WebSocket(getWsUri(n));websocketArr[n]=o,o.onclose=function(){},o.onerror=function(o){ons.notification.toast({message:"Cannot connect to device "+t.toString(),timeout:2e3}),setTimeout(function(){$("#conn_status_icon_"+t).css("color","red")},1),setTimeout(function(){$("#conn_status_icon_"+(t+1)).css("color","red")},1),retry(n)},o.onopen=function(o){ons.notification.toast({message:"Connected to device "+t.toString(),timeout:2e3}),setTimeout(function(){$("#conn_status_icon_"+t).css("color","yellowgreen")},1),setTimeout(function(){$("#conn_status_icon_"+(t+1)).css("color","yellowgreen")},1),setTimeout(function(){doSend(n,"update",0)},1e3)},o.onclose=function(o){ons.notification.toast({message:"Disconnected. Retrying "+t.toString(),timeout:2e3}),retry(n)},o.onmessage=function(t){try{let o=JSON.parse(t.data),e=o.id+n;if(void 0!==o.position&&$("#pbar_"+(e+1).toString()).attr("value",o.position),void 0!==o.set&&$("#setrange_"+(e+1).toString()).val(o.set),void 0!==o.scheduledOpen){let s=$("#timepicker_open_"+(e+1).toString());s&&s.val(o.scheduledOpen)}if(void 0!==o.scheduledClose){let i=$("#timepicker_close_"+(e+1).toString());i&&i.val(o.scheduledClose)}void 0!==o.scheduleSuccess&&(!0===o.scheduleSuccess?ons.notification.toast({message:"Schedule action for  "+(e+1).toString()+" saved successfully",timeout:1e3}):ons.notification.toast({message:"Couldn't save schedule action for  "+(e+1).toString(),timeout:1e3}))}catch(c){}}}catch(e){ons.notification.toast({message:"Cannot connect to device "+t.toString()+". Retrying...",timeout:2e3}),setTimeout(function(){$("#conn_status_icon_"+t).css("color","red")},1),setTimeout(function(){$("#conn_status_icon_"+(t+1)).css("color","red")},1),retry(n)}}function doSend(n,t,o){let e='{"id": '+(n||0).toString()+', "action": "'+t+'", "value": "'+o.toString()+'"}';if(void 0!==n){let s=websocketArr[Math.floor(n/2)];s&&1==s.readyState&&s.send(e)}else websocketArr.forEach(function(n,t,o){n&&1==n.readyState&&n.send(e)})}function closeAllWs(){websocketArr.forEach(n=>{n&&1==n.readyState&&n.close()})}window.addEventListener("load",onload,!1),window.onbeforeunload=function(){closeAllWs()};</script></head><body><ons-splitter><ons-splitter-side id="menu" side="left" width="220px" collapse swipeable><ons-page><ons-list><ons-list-item onclick='fn.load("home.html")' tappable>Home</ons-list-item><ons-list-item onclick='fn.load("settings.html")' tappable>Settings</ons-list-item><ons-list-item onclick='fn.load("about.html")' tappable>About</ons-list-item></ons-list></ons-page></ons-splitter-side><ons-splitter-content id="content" page="home.html"></ons-splitter-content></ons-splitter><template id="home.html"><ons-page><ons-toolbar><div class="left"><ons-toolbar-button onclick="fn.open()"><ons-icon icon="md-menu"></ons-icon></ons-toolbar-button></div></ons-toolbar><div id="pageContent"></div><ons-card id="update-card" style="display:none"><div class="title">Update available</div><div class="content">You are running<span id="cversion"></span>and<span id="nversion"></span>is the latest. Go to<a href="https://github.com/ahmetsari/motor-on-roller-blind-ws/releases">the repo</a>to download</div></ons-card></ons-page></template><template id="settings.html"><ons-page><ons-toolbar><div class="left"><ons-toolbar-button onclick="fn.open()"><ons-icon icon="md-menu"></ons-icon></ons-toolbar-button></div><div class="center">Settings</div></ons-toolbar><ons-card><div class="title">Instructions</div><div class="content"><p><ol><li>Use the arrows and stop button to navigate to the top position i.e. the blind is opened</li><li>Click the START button</li><li>Use the down arrow to navigate to the max closed position</li><li>Click the MAX button</li><li>Calibration is completed!</li></ol></p></div></ons-card><div id="settingsContent"></div></ons-page></template><template id="about.html"><ons-page><ons-toolbar><div class="left"><ons-toolbar-button onclick="fn.open()"><ons-icon icon="md-menu"></ons-icon></ons-toolbar-button></div><div class="center">About</div></ons-toolbar><ons-card><div class="title">Motor on a roller blind</div><div class="content"><ul><li>Github:<a href="https://github.com/ahmetsari/motor-on-roller-blind-ws" target="_blank">https://github.com/ahmetsari/motor-on-roller-blind-ws</a></li></ul></div></ons-card></ons-page></template></body></html>
)=====";
